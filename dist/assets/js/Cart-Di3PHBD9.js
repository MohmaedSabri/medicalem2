var e=Object.defineProperty,s=Object.defineProperties,a=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,l=(s,a,t)=>a in s?e(s,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[a]=t;import{j as c,S as n,m as o,a0 as d,T as m,A as x,ad as p,f as h}from"./ui-BglTUr7k.js";import{u,r as g}from"./router-DUrmdcjM.js";import{u as y,l as b,n as j}from"./index-BwoV2Gk1.js";import{g as f,r as v,u as N,c as w,a as k}from"./cart-yxqAXtgo.js";import{F as C}from"./Footer-GzJlEsEj.js";import{u as S}from"./i18n-CDketmam.js";import"./vendor-BXA9EqPX.js";import"./utils-CgVoQTuC.js";const T=()=>{const e=u(),{currentLanguage:T}=y(),{t:O}=S(),[H,_]=g.useState(f()),{data:D=[],isLoading:M,error:A}=b(),E=g.useCallback(e=>e?"string"==typeof e?e:"object"==typeof e&&(e[T]||e.en||e.ar)||"":"",[T]),F=g.useMemo(()=>D.map(e=>{var s;return{_id:e._id,name:E(e.name),description:E(e.description),longDescription:E(e.longDescription),image:e.image,images:e.images,category:"string"==typeof e.subcategory?e.subcategory:E(null==(s=e.subcategory)?void 0:s.name),price:e.price,rating:e.averageRating||0,reviews:e.reviews||[],features:(e.features||[]).map(e=>E(e)),specifications:e.specifications,inStock:e.inStock,stockQuantity:e.stockQuantity,shipping:E(e.shipping),warranty:E(e.warranty),certifications:e.certifications}}),[D,E]);g.useEffect(()=>{const e=e=>{"cart"===e.key&&_(f())};return window.addEventListener("storage",e),()=>{window.removeEventListener("storage",e)}},[]);const L=g.useCallback(e=>{const s=F.find(s=>s._id===e),a=v(e);_(a),s&&j.success(`${s.name} ${O("removedFromCartMessage")}`,{duration:2e3,icon:"🗑️",style:{background:"#ef4444",color:"#fff"}})},[F,O]),P=g.useCallback((e,s)=>{const a=N(e,s);_(a)},[]),Q=g.useCallback(()=>{const e=w();_(e),j.success(O("cartClearedMessage"),{duration:2e3,icon:"🧹",style:{background:"#f59e0b",color:"#fff"}})},[O]),I=g.useMemo(()=>{const e=new Map;return H.forEach(c=>{const n=F.find(e=>e._id===c.id);var o,d;n&&e.set(c.id,(o=((e,s)=>{for(var a in s||(s={}))r.call(s,a)&&l(e,a,s[a]);if(t)for(var a of t(s))i.call(s,a)&&l(e,a,s[a]);return e})({},n),d={cartQuantity:c.quantity,addedAt:c.addedAt},s(o,a(d))))}),Array.from(e.values()).sort((e,s)=>s.addedAt-e.addedAt)},[F,H]),q=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(e),U=g.useMemo(()=>k(F),[F]),$=g.useMemo(()=>H.reduce((e,s)=>e+s.quantity,0),[H]);return A?c.jsx("div",{className:"min-h-screen bg-gray-50 pt-16 sm:pt-20 lg:pt-24",children:c.jsx("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 py-12",children:c.jsxs("div",{className:"text-center py-20",children:[c.jsx("div",{className:"text-red-500 mb-4",children:c.jsx(n,{className:"w-16 h-16 mx-auto mb-4"})}),c.jsx("h3",{className:"text-2xl font-semibold text-gray-900 mb-2",children:O("errorLoadingCartTitle")}),c.jsx("p",{className:"text-gray-600 mb-6",children:O("errorLoadingCartDescription")}),c.jsx("button",{onClick:()=>window.location.reload(),className:"bg-primary-600 text-white px-6 py-3 rounded-lg hover:bg-primary-700 transition-colors",children:O("retry")})]})})}):M?c.jsx("div",{className:"min-h-screen bg-gray-50 pt-16 sm:pt-20 lg:pt-24",children:c.jsx("div",{className:"flex items-center justify-center w-full h-[calc(100vh-6rem)] px-4 sm:px-6 lg:px-8",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-4 border-primary-200 border-t-primary-600 mx-auto mb-4"}),c.jsx("p",{className:"text-gray-600",children:O("loadingCart")})]})})}):c.jsxs("div",{className:"min-h-screen bg-gray-50 pt-16 sm:pt-20 lg:pt-24",children:[c.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 py-12",children:[c.jsx(o.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-center mb-12",children:c.jsx("p",{className:"text-xl text-gray-600 max-w-3xl mx-auto",children:O("cartSubtitle")})}),0===I.length?c.jsxs("div",{className:"text-center py-20",children:[c.jsx(n,{className:"w-12 h-12 text-primary-600 mx-auto mb-4"}),c.jsx("h3",{className:"text-2xl font-semibold text-gray-900 mb-2",children:O("cartEmpty")}),c.jsx("p",{className:"text-gray-600 mb-6",children:O("emptyCartHint")}),c.jsxs(o.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>e("/products"),className:"inline-flex items-center space-x-2 bg-primary-600 text-white px-6 py-3 rounded-xl font-semibold hover:bg-primary-700 transition-colors",children:[c.jsx("span",{children:O("browseProducts")}),c.jsx(d,{className:"w-5 h-5"})]})]}):c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[c.jsxs("div",{className:"lg:col-span-2",children:[c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[c.jsxs("h2",{className:"text-2xl font-semibold text-gray-900",children:[O("cartItems")," (",$,")"]}),$>0&&c.jsxs(o.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:Q,className:"text-red-600 hover:text-red-700 text-sm font-medium flex items-center space-x-1",children:[c.jsx(m,{className:"w-4 h-4"}),c.jsx("span",{children:O("clearCart")})]})]}),c.jsx("div",{className:"space-y-4",children:c.jsx(x,{children:I.map(e=>c.jsx(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"bg-white rounded-2xl shadow-lg overflow-hidden border border-gray-100",children:c.jsxs("div",{className:"flex items-center p-4",children:[c.jsx("div",{className:"flex-shrink-0 w-20 h-20 sm:w-24 sm:h-24",children:c.jsx("img",{src:e.image,alt:e.name,className:"w-full h-full object-cover rounded-lg"})}),c.jsxs("div",{className:"flex-1 ml-4 sm:ml-6",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-1",children:e.name}),c.jsx("p",{className:"text-gray-600 text-sm line-clamp-2 mb-2",children:e.description}),c.jsx("div",{className:"text-primary-600 font-bold text-lg",children:q(e.price)})]}),c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg",children:[c.jsx(o.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:()=>P(e._id,e.cartQuantity-1),className:"p-2 hover:bg-gray-100 transition-colors",children:c.jsx(p,{className:"w-4 h-4"})}),c.jsx("span",{className:"px-3 py-2 text-sm font-medium min-w-[3rem] text-center",children:e.cartQuantity}),c.jsx(o.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:()=>P(e._id,e.cartQuantity+1),className:"p-2 hover:bg-gray-100 transition-colors",children:c.jsx(h,{className:"w-4 h-4"})})]}),c.jsx(o.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:()=>L(e._id),className:"p-2 text-red-600 hover:text-red-700 hover:bg-red-50 rounded-lg transition-colors",children:c.jsx(m,{className:"w-4 h-4"})})]})]})},e._id))})})]}),c.jsx("div",{className:"lg:col-span-1",children:c.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6 sticky top-24",children:[c.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:O("orderSummary")}),c.jsxs("div",{className:"space-y-3 mb-6",children:[c.jsxs("div",{className:"flex justify-between text-sm",children:[c.jsx("span",{className:"text-gray-600",children:O("subtotal")}),c.jsx("span",{className:"font-medium",children:q(U)})]}),c.jsxs("div",{className:"flex justify-between text-sm",children:[c.jsx("span",{className:"text-gray-600",children:O("shipping")}),c.jsx("span",{className:"font-medium text-green-600",children:O("free")})]}),c.jsx("div",{className:"border-t border-gray-200 pt-3",children:c.jsxs("div",{className:"flex justify-between text-lg font-semibold",children:[c.jsx("span",{children:O("total")}),c.jsx("span",{className:"text-primary-600",children:q(U)})]})})]}),c.jsx(o.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>e("/checkout"),className:"w-full bg-primary-600 text-white py-3 px-4 rounded-xl font-semibold hover:bg-primary-700 transition-colors mb-4",children:O("proceedToCheckout")}),c.jsx(o.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>e("/products"),className:"w-full border border-primary-600 text-primary-600 py-3 px-4 rounded-xl font-semibold hover:bg-primary-50 transition-colors",children:O("continueShopping")})]})})]})]}),c.jsx(C,{})]})};export{T as default};
