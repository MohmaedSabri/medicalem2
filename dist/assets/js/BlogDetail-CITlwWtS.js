var e=Object.defineProperty,a=Object.defineProperties,s=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,n=(a,s,t)=>s in a?e(a,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[s]=t,i=(e,a)=>{for(var s in a||(a={}))r.call(a,s)&&n(e,s,a[s]);if(t)for(var s of t(a))l.call(a,s)&&n(e,s,a[s]);return e},d=(e,t)=>a(e,s(t));import{j as o,B as c,W as m,m as x,q as h,h as g,U as p,i as u,J as b,e as j,a as y,Y as N,r as f}from"./ui-amuGBMtc.js";import{d as v,a as w,r as C,L as k}from"./router-DkUHWNsB.js";import{u as P,f as E,g as O,h as A,c as S,i as T,j as D}from"./index-CSO8uAfc.js";import{u as L}from"./i18n-5IHHS4r4.js";import"./vendor-BfBH_4IJ.js";import"./utils-CW8F7fbR.js";const z=()=>{const{t:e}=L(),{currentLanguage:a}=P(),{id:s}=v(),t=w(),{user:r}=E(),[l,n]=C.useState(!1),{data:z,isLoading:U,error:q}=O(s,a),{mutate:I,isPending:B}=A(),{categories:F}=S(),[M,Y]=C.useState(1),[_,J]=C.useState({authorName:"",authorEmail:"",content:""}),{data:R,isLoading:W}=T(s,M,10),{mutate:G,isPending:H}=D(),K=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),Q=()=>{var e;if(!z)return"";const s=z;if(null==(e=s.localized)?void 0:e.title)return s.localized.title;const t=s.title;return"string"==typeof t?t:t&&"object"==typeof t&&(t[a]||t.en||t.ar)||""},V=()=>{var e;if(!z)return[];const s=z;if(null==(e=s.localized)?void 0:e.content)return s.localized.content;const t=s.content;return Array.isArray(t)?t:t&&"object"==typeof t&&(t[a]||t.en||t.ar)||[]};return U?o.jsx("div",{className:"min-h-screen bg-white pt-32",children:o.jsx("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:o.jsx("div",{className:"max-w-4xl mx-auto",children:o.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 animate-pulse border border-gray-100",children:[o.jsx("div",{className:"h-8 bg-gray-200 rounded mb-4"}),o.jsx("div",{className:"h-4 bg-gray-200 rounded mb-2 w-3/4"}),o.jsx("div",{className:"h-4 bg-gray-200 rounded mb-6 w-1/2"}),o.jsx("div",{className:"h-96 bg-gradient-to-br from-gray-100 to-gray-200 rounded mb-6"}),o.jsxs("div",{className:"space-y-3",children:[o.jsx("div",{className:"h-4 bg-gray-200 rounded"}),o.jsx("div",{className:"h-4 bg-gray-200 rounded w-5/6"}),o.jsx("div",{className:"h-4 bg-gray-200 rounded w-4/6"}),o.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/6"})]})]})})})}):q||!z?o.jsx("div",{className:"min-h-screen bg-white pt-32",children:o.jsx("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:o.jsx("div",{className:"max-w-4xl mx-auto text-center",children:o.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 border border-gray-100",children:[o.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-red-100 rounded-full mb-4",children:o.jsx(c,{className:"w-8 h-8 text-red-600"})}),o.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:e("postNotFound")}),o.jsx("p",{className:"text-gray-600 mb-6",children:e("postNotFoundDescription")}),o.jsxs(k,{to:"/blog",className:"inline-flex items-center space-x-2 px-6 py-3 bg-teal-600 text-white rounded-lg hover:bg-teal-700 transition-colors",children:[o.jsx(m,{className:"w-4 h-4"}),o.jsx("span",{children:e("backToBlog")})]})]})})})}):o.jsxs("div",{className:"min-h-screen bg-white",children:[o.jsx("div",{className:"pt-32 pb-8",children:o.jsx("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:o.jsxs(x.button,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.6},onClick:()=>t("/blog"),className:"inline-flex items-center space-x-2 text-teal-600 hover:text-teal-800 font-medium mb-6 transition-colors",children:[o.jsx(m,{className:"w-4 h-4"}),o.jsx("span",{children:e("backToBlog")})]})})}),o.jsx("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 pb-16",children:o.jsxs("div",{className:"max-w-4xl mx-auto",children:[o.jsxs(x.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-white rounded-xl shadow-lg overflow-hidden border border-gray-100",children:[o.jsxs("div",{className:"relative",children:[o.jsx("img",{src:z.postImage,alt:Q(),className:"w-full h-96 object-cover"}),o.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-black/10 via-transparent to-teal-600/20"}),o.jsx("div",{className:"absolute top-4 left-4",children:o.jsxs("span",{className:"inline-flex items-center space-x-1 bg-white/95 backdrop-blur-sm text-gray-800 px-4 py-2 text-sm font-medium rounded-lg border border-white/20 shadow-lg",children:[o.jsx(h,{className:"w-4 h-4 text-teal-600"}),o.jsx("span",{children:(e=>{if("string"==typeof e){const s=F.find(a=>a._id===e);return s?"string"==typeof s.name?s.name:s.name&&"object"==typeof s.name?s.name[a]||s.name.en||s.name.ar||"":e:e}return"string"==typeof e.name?e.name:e.name&&"object"==typeof e.name&&(e.name[a]||e.name.en||e.name.ar)||""})(z.category)})]})}),z.featured&&o.jsx("div",{className:"absolute top-4 right-4",children:o.jsxs("span",{className:"inline-flex items-center space-x-1 bg-yellow-500 text-white px-4 py-2 text-sm font-medium rounded-lg shadow-lg",children:[o.jsx(g,{className:"w-4 h-4"}),o.jsx("span",{children:e("featured")})]})})]}),o.jsxs("div",{className:"p-8",children:[o.jsxs("div",{className:"mb-8 bg-white rounded-xl border border-gray-100 p-6 shadow-sm",children:[o.jsxs("h3",{className:"text-2xl font-bold text-gray-900 mb-4 flex items-center space-x-2",children:[o.jsx(p,{className:"w-6 h-6 text-teal-600"}),o.jsx("span",{children:e("aboutTheAuthor")})]}),o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsx("div",{className:"w-14 h-14 bg-teal-100 rounded-full flex items-center justify-center",children:o.jsx(p,{className:"w-7 h-7 text-teal-600"})}),o.jsxs("div",{children:[o.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:z.authorName}),o.jsx("p",{className:"text-gray-600",children:z.authorEmail})]})]})]}),o.jsxs("header",{className:"mb-8",children:[o.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-4 leading-tight",children:Q()}),o.jsxs("div",{className:"flex flex-wrap items-center gap-6 text-gray-600 mb-6",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(p,{className:"w-5 h-5 text-teal-600"}),o.jsx("span",{children:z.authorName})]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(u,{className:"w-5 h-5 text-teal-600"}),o.jsx("span",{children:K(z.createdAt)})]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(b,{className:"w-5 h-5 text-teal-600"}),o.jsxs("span",{children:[(e=>{let a=0;return e.forEach(e=>{if("paragraph"===e.type){const s=e.text.trim().split(/\s+/).length;if(a+=s,e.title){const s=e.title.trim().split(/\s+/).length;a+=s}}}),Math.ceil(a/200)})(V())," ",e("minRead")]})]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(j,{className:"w-5 h-5 text-teal-600"}),o.jsxs("span",{children:[z.views," ",e("views")]})]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(y,{className:"w-5 h-5 text-teal-600"}),o.jsxs("span",{children:[z.likes," ",e("likes")]})]})]}),z.tags&&z.tags.length>0&&o.jsx("div",{className:"flex flex-wrap gap-2",children:z.tags.map((e,a)=>o.jsxs("span",{className:"px-3 py-1 bg-teal-100 text-teal-700 text-sm rounded-full border border-teal-200",children:["#",e]},a))})]}),o.jsx("article",{className:"prose prose-lg max-w-none mb-8",children:o.jsx("div",{className:"text-gray-700 leading-relaxed",children:V().map((e,a)=>o.jsx("div",{className:"mb-6",children:"paragraph"===e.type?o.jsxs("div",{children:[e.title&&o.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-3",children:e.title}),o.jsx("p",{className:"leading-relaxed",children:e.text})]}):"image"===e.type?o.jsxs("div",{className:"my-8",children:[o.jsx("img",{src:e.imageUrl,alt:e.imageAlt||"Post image",className:"w-full h-auto rounded-lg shadow-lg",loading:"lazy",onError:e=>{e.currentTarget.style.display="none";const a=e.currentTarget.nextElementSibling;a&&(a.style.display="block")},onLoad:()=>{}}),o.jsx("div",{className:"w-full h-48 bg-gradient-to-br from-gray-50 to-gray-100 rounded-lg shadow-lg flex items-center justify-center text-gray-500 border-2 border-dashed border-gray-200",style:{display:"none"},children:o.jsxs("div",{className:"text-center p-4",children:[o.jsx(h,{className:"w-12 h-12 mx-auto mb-3 text-gray-400"}),o.jsx("p",{className:"text-sm font-medium text-gray-600 mb-2",children:"Image unavailable"}),o.jsx("p",{className:"text-xs text-gray-400 break-all max-w-xs",children:e.imageUrl})]})}),e.imageCaption&&o.jsx("p",{className:"text-sm text-gray-600 italic mt-2 text-center",children:e.imageCaption})]}):null},a))})}),o.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4 pt-8 border-t border-gray-200",children:[o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsxs("button",{onClick:()=>{r?s&&(I(s),n(!0)):t("/login")},disabled:B||l,className:"flex items-center space-x-2 px-6 py-3 rounded-lg transition-colors "+(l?"bg-red-100 text-red-600 border border-red-200":"bg-gray-100 text-gray-700 hover:bg-gray-200 border border-gray-200"),children:[o.jsx(y,{className:"w-5 h-5 "+(l?"fill-current":"")}),o.jsx("span",{children:e(l?"liked":"like")})]}),o.jsxs("button",{onClick:()=>{return e=function*(){if(navigator.share&&z)try{const e=V().find(e=>"paragraph"===e.type),a=e&&"paragraph"===e.type?e.text.substring(0,100)+"...":"";yield navigator.share({title:Q(),text:a,url:window.location.href})}catch(e){}else navigator.clipboard.writeText(window.location.href)},new Promise((a,s)=>{var t=a=>{try{l(e.next(a))}catch(t){s(t)}},r=a=>{try{l(e.throw(a))}catch(t){s(t)}},l=e=>e.done?a(e.value):Promise.resolve(e.value).then(t,r);l((e=e.apply(null,null)).next())});var e},className:"flex items-center space-x-2 px-6 py-3 bg-teal-100 text-teal-700 rounded-lg hover:bg-teal-200 transition-colors border border-teal-200",children:[o.jsx(N,{className:"w-5 h-5"}),o.jsx("span",{children:e("share")})]})]}),o.jsxs("div",{className:"text-sm text-gray-500",children:[e("lastUpdated"),": ",K(z.updatedAt)]})]})]})]}),o.jsxs(x.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.2},className:"mt-8 bg-white rounded-xl shadow-lg p-8 border border-gray-100",children:[o.jsxs("h3",{className:"text-2xl font-bold text-gray-900 mb-6 flex items-center space-x-2",children:[o.jsx(f,{className:"w-6 h-6 text-teal-600"}),o.jsxs("span",{children:[e("comments")," (",(null==R?void 0:R.totalComments)||0,")"]})]}),o.jsxs("form",{onSubmit:e=>{e.preventDefault(),_.authorName.trim()&&_.authorEmail.trim()&&_.content.trim()&&s&&(G({postId:s,commentData:{authorName:_.authorName.trim(),authorEmail:_.authorEmail.trim(),content:_.content.trim()}}),J({authorName:"",authorEmail:"",content:""}))},className:"mb-8 p-6 bg-gray-50 rounded-xl",children:[o.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-4",children:e("addComment")}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[o.jsx("input",{type:"text",placeholder:e("yourName"),value:_.authorName,onChange:e=>J(a=>d(i({},a),{authorName:e.target.value})),className:"px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent",required:!0}),o.jsx("input",{type:"email",placeholder:e("yourEmail"),value:_.authorEmail,onChange:e=>J(a=>d(i({},a),{authorEmail:e.target.value})),className:"px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent",required:!0})]}),o.jsx("textarea",{placeholder:e("writeComment"),value:_.content,onChange:e=>J(a=>d(i({},a),{content:e.target.value})),rows:4,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent mb-4",required:!0}),o.jsx("button",{type:"submit",disabled:H,className:"px-6 py-3 bg-teal-600 text-white rounded-lg hover:bg-teal-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:e(H?"adding":"addComment")})]}),W?o.jsx("div",{className:"space-y-4",children:Array.from({length:3}).map((e,a)=>o.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg animate-pulse",children:[o.jsx("div",{className:"h-4 bg-gray-200 rounded mb-2 w-1/4"}),o.jsx("div",{className:"h-3 bg-gray-200 rounded mb-2 w-1/6"}),o.jsx("div",{className:"h-3 bg-gray-200 rounded w-3/4"})]},a))}):(null==R?void 0:R.comments)&&R.comments.length>0?o.jsxs("div",{className:"space-y-6",children:[R.comments.map(e=>o.jsxs("div",{className:"p-6 bg-gray-50 rounded-xl border border-gray-100",children:[o.jsxs("div",{className:"mb-3",children:[o.jsx("h5",{className:"font-semibold text-gray-900",children:e.authorName}),o.jsx("p",{className:"text-sm text-gray-500",children:K(e.createdAt)})]}),o.jsx("p",{className:"text-gray-700 leading-relaxed",children:e.content})]},e._id)),R.totalPages>1&&o.jsxs("div",{className:"flex items-center justify-center space-x-2 pt-4",children:[o.jsx("button",{onClick:()=>Y(e=>Math.max(1,e-1)),disabled:1===M,className:"px-4 py-2 bg-white border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:e("previous")}),o.jsxs("span",{className:"px-4 py-2 text-gray-600",children:[M," / ",R.totalPages]}),o.jsx("button",{onClick:()=>Y(e=>Math.min(R.totalPages,e+1)),disabled:M===R.totalPages,className:"px-4 py-2 bg-white border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:e("next")})]})]}):o.jsxs("div",{className:"text-center py-8",children:[o.jsx(f,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),o.jsx("p",{className:"text-gray-600",children:e("noCommentsYet")}),o.jsx("p",{className:"text-sm text-gray-500 mt-2",children:e("beFirstToComment")})]})]})]})})]})};export{z as default};
