var e=Object.defineProperty,s=Object.defineProperties,a=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,n=(s,a,r)=>a in s?e(s,a,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[a]=r,l=(e,s)=>{for(var a in s||(s={}))t.call(s,a)&&n(e,a,s[a]);if(r)for(var a of r(s))i.call(s,a)&&n(e,a,s[a]);return e},c=(e,r)=>s(e,a(r));import{j as d,S as o,m,a0 as x,A as p,U as h,y as u,s as y,ae as g,af as j,ag as b,D as f}from"./ui-BglTUr7k.js";import{u as N,r as v,L as w}from"./router-DUrmdcjM.js";import{g as k,a as C,c as P}from"./cart-yxqAXtgo.js";import{u as A,l as D,m as O,n as M}from"./index-BwoV2Gk1.js";import{F as S}from"./Footer-GzJlEsEj.js";import{u as T}from"./i18n-CDketmam.js";import"./vendor-BXA9EqPX.js";import"./utils-CgVoQTuC.js";const _=()=>{const e=N(),{currentLanguage:s}=A(),{t:a}=T(),[r,t]=v.useState(k()),[i,n]=v.useState(!1),[_,E]=v.useState(!1),[q,F]=v.useState(""),[L,H]=v.useState(0),{data:I=[],isLoading:Q}=D(),[B,U]=v.useState({firstName:"",lastName:"",phone:"",phoneType:"home",email:"",emirate:"",address:"",orderNotes:"",paymentMethod:"bank_transfer",termsAccepted:!1}),V=v.useCallback(e=>e?"string"==typeof e?e:"object"==typeof e&&(e[s]||e.en||e.ar)||"":"",[s]),z=v.useMemo(()=>I.map(e=>{var s;return{_id:e._id,name:V(e.name),description:V(e.description),image:e.image,price:e.price,category:"string"==typeof e.subcategory?e.subcategory:V(null==(s=e.subcategory)?void 0:s.name)}}),[I,V]);v.useEffect(()=>{const e=e=>{"cart"===e.key&&t(k())};return window.addEventListener("storage",e),()=>window.removeEventListener("storage",e)},[]);const G=v.useMemo(()=>{const e=new Map;return r.forEach(s=>{const a=z.find(e=>e._id===s.id);a&&e.set(s.id,c(l({},a),{cartQuantity:s.quantity,addedAt:s.addedAt}))}),Array.from(e.values()).sort((e,s)=>s.addedAt-e.addedAt)},[z,r]),J=v.useMemo(()=>C(z),[z]),K=v.useMemo(()=>.05*J,[J]),R=v.useMemo(()=>J+K+L,[J,K,L]),W=O().emirates,X=[{id:"bank_transfer",name:"Direct bank transfer",description:"Make your payment directly into our bank account. Please use your Order ID as the payment reference.",icon:d.jsx(g,{className:"w-5 h-5"})},{id:"credit_card",name:"Credit Card on Delivery",description:"Pay using your credit card on delivery.",icon:d.jsx(b,{className:"w-5 h-5"})},{id:"cod",name:"Cash on delivery",description:"Pay with cash upon delivery.",icon:d.jsx(f,{className:"w-5 h-5"})}],Y=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"AED",minimumFractionDigits:2,maximumFractionDigits:2}).format(e),Z=e=>{const{name:s,value:a,type:r}=e.target;U(t=>c(l({},t),{[s]:"checkbox"===r?e.target.checked:a}))};return 0===r.length?d.jsxs("div",{className:"min-h-screen bg-gray-50 pt-16 sm:pt-20 lg:pt-24",children:[d.jsx("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 py-12",children:d.jsxs("div",{className:"text-center py-20",children:[d.jsx(o,{className:"w-16 h-16 text-primary-600 mx-auto mb-4"}),d.jsx("h3",{className:"text-2xl font-semibold text-gray-900 mb-2",children:a("cartEmpty")}),d.jsx("p",{className:"text-gray-600 mb-6",children:a("emptyCartHint")}),d.jsxs(m.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>e("/products"),className:"inline-flex items-center space-x-2 bg-primary-600 text-white px-6 py-3 rounded-xl font-semibold hover:bg-primary-700 transition-colors",children:[d.jsx("span",{children:a("browseProducts")}),d.jsx(x,{className:"w-5 h-5"})]})]})}),d.jsx(S,{})]}):Q?d.jsx("div",{className:"min-h-screen bg-gray-50 pt-16 sm:pt-20 lg:pt-24",children:d.jsx("div",{className:"flex items-center justify-center w-full h-[calc(100vh-6rem)] px-4 sm:px-6 lg:px-8",children:d.jsxs("div",{className:"text-center",children:[d.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-4 border-primary-200 border-t-primary-600 mx-auto mb-4"}),d.jsx("p",{className:"text-gray-600",children:a("loading")})]})})}):d.jsxs("div",{className:"min-h-screen bg-gray-50 pt-16 sm:pt-20 lg:pt-24",children:[d.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 py-12",children:[d.jsxs(m.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-center mb-12",children:[d.jsx("p",{className:"text-xl text-gray-600 max-w-3xl mx-auto",children:a("checkoutSubtitle")}),d.jsx(p,{children:_&&d.jsxs(m.form,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},onSubmit:e=>{e.preventDefault(),M.success("Coupon applied successfully!"),E(!1)},className:"mt-4 bg-white rounded-xl border border-gray-200 p-6",children:[d.jsx("p",{className:"text-gray-600 mb-4",children:a("couponDescription")}),d.jsxs("div",{className:"flex space-x-4",children:[d.jsx("input",{type:"text",value:q,onChange:e=>F(e.target.value),placeholder:a("couponCode"),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"}),d.jsx("button",{type:"submit",className:"bg-primary-600 text-white px-6 py-2 rounded-lg hover:bg-primary-700 transition-colors",children:a("applyCoupon")})]})]})})]}),d.jsxs("form",{onSubmit:s=>{return a=function*(){s.preventDefault(),n(!0);try{yield new Promise(e=>setTimeout(e,2e3)),P(),t([]),M.success("Order placed successfully!",{duration:5e3,icon:"ðŸŽ‰"}),e("/invoice")}catch(a){M.error("Failed to place order. Please try again.")}finally{n(!1)}},new Promise((e,r)=>{var t=e=>{try{n(a.next(e))}catch(s){r(s)}},i=e=>{try{n(a.throw(e))}catch(s){r(s)}},n=s=>s.done?e(s.value):Promise.resolve(s.value).then(t,i);n((a=a.apply(null,null)).next())});var a},className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[d.jsxs("div",{className:"lg:col-span-2 space-y-8",children:[d.jsxs(m.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"bg-white rounded-2xl shadow-lg p-6",children:[d.jsxs("h3",{className:"text-2xl font-semibold text-gray-900 mb-6 flex items-center space-x-2",children:[d.jsx(h,{className:"w-6 h-6 text-primary-600"}),d.jsx("span",{children:a("billingDetails")})]}),d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{children:[d.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-4",children:a("contactDetails")}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[a("firstName")," ",d.jsx("span",{className:"text-red-500",children:"*"})]}),d.jsx("input",{type:"text",name:"firstName",value:B.firstName,onChange:Z,required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),d.jsxs("div",{children:[d.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[a("lastName")," ",d.jsx("span",{className:"text-red-500",children:"*"})]}),d.jsx("input",{type:"text",name:"lastName",value:B.lastName,onChange:Z,required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),d.jsxs("div",{children:[d.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[a("phone")," ",d.jsx("span",{className:"text-red-500",children:"*"})]}),d.jsxs("div",{className:"space-y-3",children:[d.jsxs("div",{className:"flex space-x-4",children:[d.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[d.jsx("input",{type:"radio",name:"phoneType",value:"home",checked:"home"===B.phoneType,onChange:Z,className:"w-4 h-4 text-primary-600 border-gray-300 focus:ring-primary-500"}),d.jsx("span",{className:"text-sm text-gray-700",children:a("homePhone")})]}),d.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[d.jsx("input",{type:"radio",name:"phoneType",value:"clinic",checked:"clinic"===B.phoneType,onChange:Z,className:"w-4 h-4 text-primary-600 border-gray-300 focus:ring-primary-500"}),d.jsx("span",{className:"text-sm text-gray-700",children:a("clinicPhone")})]})]}),d.jsx("input",{type:"tel",name:"phone",value:B.phone,onChange:Z,required:!0,placeholder:"home"===B.phoneType?a("enterHomePhone"):a("enterClinicPhone"),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]})]}),d.jsxs("div",{children:[d.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[a("email")," ",d.jsx("span",{className:"text-red-500",children:"*"})]}),d.jsx("input",{type:"email",name:"email",value:B.email,onChange:Z,required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]})]})]}),d.jsxs("div",{children:[d.jsxs("h4",{className:"text-lg font-medium text-gray-900 mb-4 flex items-center space-x-2",children:[d.jsx(u,{className:"w-5 h-5 text-primary-600"}),d.jsx("span",{children:a("address")})]}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{children:[d.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[a("emirate")," ",d.jsx("span",{className:"text-red-500",children:"*"})]}),d.jsxs("select",{name:"emirate",value:B.emirate,onChange:e=>{const s=W.find(s=>s.name===e.target.value);H((null==s?void 0:s.cost)||0),U(s=>c(l({},s),{emirate:e.target.value}))},required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[d.jsx("option",{value:"",children:a("selectEmirate")}),W.map(e=>d.jsxs("option",{value:e.name,children:[e.name," (+",e.cost," AED)"]},e.name))]})]}),d.jsxs("div",{children:[d.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[a("streetAddress")," ",d.jsx("span",{className:"text-red-500",children:"*"})]}),d.jsx("input",{type:"text",name:"address",value:B.address,onChange:Z,required:!0,placeholder:a("streetAddressPlaceholder"),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]})]})]})]})]}),d.jsxs(m.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},className:"bg-white rounded-2xl shadow-lg p-6",children:[d.jsxs("h3",{className:"text-2xl font-semibold text-gray-900 mb-6 flex items-center space-x-2",children:[d.jsx(y,{className:"w-6 h-6 text-primary-600"}),d.jsx("span",{children:a("additionalInfo")})]}),d.jsxs("div",{children:[d.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[a("orderNotes")," ",d.jsxs("span",{className:"text-gray-500",children:["(",a("optional"),")"]})]}),d.jsx("textarea",{name:"orderNotes",value:B.orderNotes,onChange:Z,rows:3,placeholder:a("orderNotesPlaceholder"),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent"})]}),d.jsx("p",{className:"mt-4 text-sm text-gray-600 bg-yellow-50 p-3 rounded-lg",children:a("deliveryNotice")})]})]}),d.jsx("div",{className:"lg:col-span-1",children:d.jsxs(m.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},className:"bg-white rounded-2xl shadow-lg p-6 sticky top-24",children:[d.jsxs("h3",{className:"text-2xl font-semibold text-gray-900 mb-6 flex items-center space-x-2",children:[d.jsx(o,{className:"w-6 h-6 text-primary-600"}),d.jsx("span",{children:a("yourOrder")})]}),d.jsx("div",{className:"space-y-4 mb-6",children:G.map(e=>d.jsxs("div",{className:"flex items-center space-x-3 py-3 border-b border-gray-100",children:[d.jsx("img",{src:e.image,alt:e.name,className:"w-12 h-12 object-cover rounded-lg"}),d.jsxs("div",{className:"flex-1",children:[d.jsx("h4",{className:"text-sm font-medium text-gray-900 line-clamp-2",children:e.name}),d.jsxs("p",{className:"text-xs text-gray-500",children:["Ã— ",e.cartQuantity]})]}),d.jsx("span",{className:"text-sm font-semibold text-primary-600",children:Y(e.price*e.cartQuantity)})]},e._id))}),d.jsxs("div",{className:"space-y-3 mb-6",children:[d.jsxs("div",{className:"flex justify-between text-sm",children:[d.jsx("span",{className:"text-gray-600",children:a("subtotal")}),d.jsx("span",{className:"font-medium",children:Y(J)})]}),d.jsxs("div",{className:"flex justify-between text-sm",children:[d.jsx("span",{className:"text-gray-600",children:a("shipping")}),d.jsx("span",{className:"font-medium",children:L>0?Y(L):a("free")})]}),d.jsxs("div",{className:"flex justify-between text-sm",children:[d.jsxs("span",{className:"text-gray-600",children:[a("vat")," (5%)"]}),d.jsx("span",{className:"font-medium",children:Y(K)})]}),d.jsx("div",{className:"border-t border-gray-200 pt-3",children:d.jsxs("div",{className:"flex justify-between text-lg font-semibold",children:[d.jsx("span",{children:a("total")}),d.jsx("span",{className:"text-primary-600",children:Y(R)})]})})]}),d.jsxs("div",{className:"mb-6",children:[d.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-4",children:a("paymentMethods")}),d.jsx("div",{className:"space-y-3",children:X.map(e=>d.jsxs("label",{className:"flex items-start space-x-3 p-3 border rounded-lg cursor-pointer transition-colors "+(B.paymentMethod===e.id?"border-primary-500 bg-primary-50":"border-gray-200 hover:border-gray-300"),children:[d.jsx("input",{type:"radio",name:"paymentMethod",value:e.id,checked:B.paymentMethod===e.id,onChange:Z,className:"mt-1 w-4 h-4 text-primary-600 border-gray-300 focus:ring-primary-500"}),d.jsxs("div",{className:"flex-1",children:[d.jsxs("div",{className:"flex items-center space-x-2",children:[e.icon,d.jsx("span",{className:"font-medium text-gray-900",children:e.name})]}),d.jsx("p",{className:"text-sm text-gray-600 mt-1",children:e.description})]})]},e.id))}),"bank_transfer"===B.paymentMethod&&d.jsx(m.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{className:"flex items-center space-x-3",children:[d.jsx(g,{className:"w-5 h-5 text-blue-600"}),d.jsxs("div",{children:[d.jsx("p",{className:"text-sm font-medium text-blue-900",children:a("bankAccountDetails")}),d.jsx("p",{className:"text-xs text-blue-700",children:a("clickToViewBankDetails")})]})]}),d.jsxs(w,{to:"/bank-account",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center space-x-2 text-blue-600 hover:text-blue-700 font-medium text-sm transition-colors",children:[d.jsx("span",{children:a("viewBankDetails")}),d.jsx(x,{className:"w-4 h-4"})]})]})})]}),d.jsx("div",{className:"mb-6",children:d.jsxs("label",{className:"flex items-start space-x-3",children:[d.jsx("input",{type:"checkbox",name:"termsAccepted",checked:B.termsAccepted,onChange:Z,required:!0,className:"mt-1 w-4 h-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500"}),d.jsxs("span",{className:"text-sm text-gray-700",children:[a("termsAgreement")," ",d.jsx("a",{href:"/terms",className:"text-primary-600 hover:underline",target:"_blank",rel:"noopener noreferrer",children:a("termsAndConditions")})]})]})}),d.jsx(m.button,{type:"submit",disabled:i||!B.termsAccepted,whileHover:{scale:1.02},whileTap:{scale:.98},className:"w-full py-4 px-6 rounded-xl font-semibold text-lg transition-colors flex items-center justify-center space-x-2 "+(i||!B.termsAccepted?"bg-gray-400 text-gray-200 cursor-not-allowed":"bg-primary-600 text-white hover:bg-primary-700"),children:i?d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-white border-t-transparent"}),d.jsx("span",{children:a("processingOrder")})]}):d.jsxs(d.Fragment,{children:[d.jsx(j,{className:"w-5 h-5"}),d.jsx("span",{children:a("placeOrder")})]})})]})})]})]}),d.jsx(S,{})]})};export{_ as default};
